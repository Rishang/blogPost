{% extends 'blog/base.html' %}
{% load static %}
{% load tag_tweak %}

{% block scriptsrc %}
<script src="https://cdn.jsdelivr.net/npm/vue@2.6.12"></script>
<script src="https://unpkg.com/marked@0.3.6"></script>
<script src="https://unpkg.com/lodash@4.16.0"></script>
{% endblock scriptsrc %}

{% block style %}
<link href="https://fonts.googleapis.com/css2?family=Crimson+Text&display=swap" rel="stylesheet">
<link rel="stylesheet" href="{% static 'css/custom.css' %}">
{% endblock style %}


{% block content %}

{% include "blog/nav.html" %}
<!-- <header class="masthead" style="background-image: url( https://images.unsplash.com/photo-1527352675495-d54e8f102689?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=750&q=80 )"> -->
<div class="container-fluid">
  <br><br><br>
  <form action="" method="post">
    {% csrf_token %}
    <div class="form-group floating-label-form-group controls">
      <label for="id_title" value='title'>Title</label>
      {% render_field form.title placeholder="Title" class="form-control" maxlength="500"  %}
    </div>
    <br>
    <div class="form-group floating-label-form-group controls">
      <label>Description</label>
      {% render_field form.description placeholder="Description" class="form-control" cols="30" rows="5" %}
    </div>
    <br>
    <div class="form-group floating-label-form-group controls">
      <div id="editor">
        <label>Content:</label>
        {{form.content | attr:"style:font-family: 'Crimson Text', serif;border-right: 1px solid #c7c7c7"| attr:"placeholder:Content"| attr:"@input:update" | attr:"v-html::compiledMarkdown"| attr:"rows:100%"}}
        <div v-html="compiledMarkdown"></div>
      </div>
      <br>
    </div>
    <br>
    <input class="btn btn-primary" type="submit" value="submit">
  </form>
  
  <div id="editor">
  </div>
  <br><br>
</div>
{# <a href="{% url 'about-us' %}">About Us</a> #}

{% endblock content %}

{% block scripts %}

<script>
    new Vue({
      el: "#editor",
      data: {
        input: "> Markdown output will get shown here"
      },
      computed: {
        compiledMarkdown: function() {
          return marked(this.input, { sanitize: true });
        }
      },
      methods: {
        update: _.debounce(function(e) {
          this.input = e.target.value;
        }, 100)
      }
    });
  </script>
  <script>
    navLink = document.getElementsByClassName('nav-link');
    navBrand = document.getElementsByClassName('navbar-brand');
    for (i=0; i < navLink.length; i++){
      navLink[i].style.color = 'black'
    }

    for (i=0; i < navBrand.length; i++){
      navBrand[i].style.color = 'black'
    }

    document.getElementById('mainNav').style.backgroundColor = 'rgba(255,250,250,0.2)'
  </script>
{% endblock scripts %}
